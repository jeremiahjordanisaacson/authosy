---
interface Props {
  slug: string;
  title: string;
  region: string;
  date_published: string;
  summary: string;
  tags: string[];
}

const { slug, title, region, date_published, summary, tags } = Astro.props;
const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith('/') ? rawBase : rawBase + '/';
const dateStr = new Date(date_published).toLocaleDateString('en-US', {
  year: 'numeric', month: 'short', day: 'numeric'
});
---
<article class="story-card">
  <h3><a href={`${base}stories/${slug.replace(/\.md$/, '')}/`}>{title}</a></h3>
  <div class="story-meta">
    <span class="region-badge">{region}</span>
    <time datetime={date_published}>{dateStr}</time>
  </div>
  <p class="story-summary">{summary}</p>
  <div class="story-tags">
    {tags.slice(0, 4).map((tag) => <span class="tag">{tag}</span>)}
  </div>
</article>
